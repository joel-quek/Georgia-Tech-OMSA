import streamlit as st
import pydeck as pdk
import numpy as np

# Sample latitude and longitude coordinates for airport codes (expand this dictionary with actual coordinates)
airport_coordinates = {
    'ATL': {'lat': 33.6367, 'lon': -84.428101}, 'LAX': {'lat': 33.94250107, 'lon': -118.4079971}, 'ORD': {'lat': 41.9786, 'lon': -87.9048}, 'DFW': {'lat': 32.896801, 'lon': -97.038002}, 'JFK': {'lat': 40.63980103, 'lon': -73.77890015}, 'PPG': {'lat': -14.33100033, 'lon': -170.7100067}, 'SPN': {'lat': 15.119, 'lon': 145.729004}, 'GUM': {'lat': 13.48340034, 'lon': 144.7960052}, 'STT': {'lat': 18.337299346923828, 'lon': -64.9733963}, 'STX': {'lat': 17.701900482177734, 'lon': -64.79859924}, 'BQN': {'lat': 18.49489974975586, 'lon': -67.12940216}, 'PSE': {'lat': 18.00830078, 'lon': -66.56300354}, 'SJU': {'lat': 18.43939972, 'lon': -66.00180054}, 'ITO': {'lat': 19.721399307250977, 'lon': -155.0480042}, 'FSM': {'lat': 35.33660125732422, 'lon': -94.36740112}, 'GFK': {'lat': 47.949299, 'lon': -97.176102}, 'PRC': {'lat': 34.65449905, 'lon': -112.4199982}, 'TTN': {'lat': 40.27669906616211, 'lon': -74.81349945}, 'BOS': {'lat': 42.36429977, 'lon': -71.00520325}, 'BFM': {'lat': 30.626800537100003, 'lon': -88.06809998}, 'OAK': {'lat': 37.721298, 'lon': -122.221001}, 'OMA': {'lat': 41.3032, 'lon': -95.894096}, 'OGG': {'lat': 20.8986, 'lon': -156.429993}, 'ICT': {'lat': 37.649899, 'lon': -97.433098}, 'MCI': {'lat': 39.2976, 'lon': -94.713898}, 'MSN': {'lat': 43.13990020751953, 'lon': -89.33750153}, 'DLG': {'lat': 59.04470062, 'lon': -158.5050049}, 'PHX': {'lat': 33.43429946899414, 'lon': -112.012001}, 'BGR': {'lat': 44.80739974975586, 'lon': -68.82810211}, 'GGG': {'lat': 32.38399887084961, 'lon': -94.71150208}, 'GEG': {'lat': 47.61989974975586, 'lon': -117.5339966}, 'SFO': {'lat': 37.61899948120117, 'lon': -122.375}, 'GNV': {'lat': 29.69009972, 'lon': -82.27179718}, 'MEM': {'lat': 35.04240036010742, 'lon': -89.97669983}, 'CLE': {'lat': 41.4117012, 'lon': -81.84980011}, 'CVG': {'lat': 39.04880142, 'lon': -84.6678009}, 'JNU': {'lat': 58.35499954223633, 'lon': -134.576004}, 'LFT': {'lat': 30.20529938, 'lon': -91.98760223}, 'EWR': {'lat': 40.692501068115234, 'lon': -74.16870117}, 'BOI': {'lat': 43.5644, 'lon': -116.223}, 'GCK': {'lat': 37.92750168, 'lon': -100.723999}, 'MOT': {'lat': 48.25939941, 'lon': -101.2799988}, 'DAL': {'lat': 32.847099, 'lon': -96.851799}, 'HLN': {'lat': 46.60680008, 'lon': -111.9830017}, 'LCH': {'lat': 30.126100540161133, 'lon': -93.22329712}, 'KOA': {'lat': 19.738783, 'lon': -156.045603}, 'MYR': {'lat': 33.67969894, 'lon': -78.92829895}, 'ACK': {'lat': 41.25310135, 'lon': -70.06020355}, 'DCA': {'lat': 38.8521, 'lon': -77.037697}, 'ACY': {'lat': 39.45759963989258, 'lon': -74.57720184}, 'PUB': {'lat': 38.289100646972656, 'lon': -104.4970016}, 'ADQ': {'lat': 57.75, 'lon': -152.4940033}, 'FLL': {'lat': 26.072599, 'lon': -80.152702}, 'INL': {'lat': 48.566200256347656, 'lon': -93.40309906}, 'SLC': {'lat': 40.78839874267578, 'lon': -111.9779968}, 'MDT': {'lat': 40.19350052, 'lon': -76.76339722}, 'LNK': {'lat': 40.85100173950195, 'lon': -96.75920105}, 'LAN': {'lat': 42.77870178222656, 'lon': -84.58740234}, 'IAH': {'lat': 29.984399795532227, 'lon': -95.34140015}, 'BFL': {'lat': 35.43360138, 'lon': -119.0569992}, 'ELP': {'lat': 31.80719948, 'lon': -106.3779984}, 'HRL': {'lat': 26.228500366210938, 'lon': -97.65440369}, 'CAE': {'lat': 33.93880081176758, 'lon': -81.11949921}, 'PNS': {'lat': 30.47340012, 'lon': -87.18659973}, 'HOU': {'lat': 29.64539909, 'lon': -95.27890015}, 'PIT': {'lat': 40.49150085, 'lon': -80.23290253}, 'BRW': {'lat': 71.285402, 'lon': -156.766008}, 'MIA': {'lat': 25.79319953918457, 'lon': -80.29060364}, 'SEA': {'lat': 47.449001, 'lon': -122.308998}, 'CHA': {'lat': 35.035301208496094, 'lon': -85.20379639}, 'JAN': {'lat': 32.31119919, 'lon': -90.07589722}, 'LGB': {'lat': 33.81769943, 'lon': -118.1520004}, 'IPT': {'lat': 41.241798400878906, 'lon': -76.9210968}, 'IND': {'lat': 39.7173, 'lon': -86.294403}, 'HPN': {'lat': 41.06700134277344, 'lon': -73.70760345}, 'YUM': {'lat': 32.65660095, 'lon': -114.6060028}, 'DLH': {'lat': 46.84209824, 'lon': -92.19360352}, 'BET': {'lat': 60.77980042, 'lon': -161.8379974}, 'LIH': {'lat': 21.97599983215332, 'lon': -159.3390045}, 'RIC': {'lat': 37.50519943237305, 'lon': -77.31970215}, 'SHV': {'lat': 32.446602, 'lon': -93.8256}, 'CDV': {'lat': 60.4917984, 'lon': -145.4779968}, 'ORF': {'lat': 36.89459991455078, 'lon': -76.20120239}, 'BPT': {'lat': 29.95079994, 'lon': -94.02069855}, 'SAV': {'lat': 32.12760162, 'lon': -81.20210266}, 'OME': {'lat': 64.51219940185547, 'lon': -165.4450073}, 'PIE': {'lat': 27.91020012, 'lon': -82.68740082}, 'SCC': {'lat': 70.19470215, 'lon': -148.4649963}, 'SAT': {'lat': 29.533700942993164, 'lon': -98.46980286}, 'ROC': {'lat': 43.118900299072266, 'lon': -77.67240143}, 'RDU': {'lat': 35.87760162353516, 'lon': -78.78749847}, 'DAY': {'lat': 39.90240097045898, 'lon': -84.2193985}, 'IAG': {'lat': 43.1072998, 'lon': -78.94619751}, 'PHF': {'lat': 37.13190079, 'lon': -76.49299622}, 'TUS': {'lat': 32.11610031, 'lon': -110.9410019}, 'PVD': {'lat': 41.732601, 'lon': -71.420403}, 'BUR': {'lat': 34.20069885253906, 'lon': -118.3590012}, 'DTW': {'lat': 42.212398529052734, 'lon': -83.35340118}, 'TPA': {'lat': 27.975500106811523, 'lon': -82.53320313}, 'HIB': {'lat': 47.38660049, 'lon': -92.83899689}, 'MAF': {'lat': 31.94249916, 'lon': -102.2020035}, 'GRB': {'lat': 44.48509979248047, 'lon': -88.12960052}, 'AGS': {'lat': 33.36989974975586, 'lon': -81.96450043}, 'ISN': {'lat': 48.17789841, 'lon': -103.6419983}, 'LIT': {'lat': 34.729400634799994, 'lon': -92.22429657}, 'SWF': {'lat': 41.50410079956055, 'lon': -74.10479736}, 'TBN': {'lat': 37.74160004, 'lon': -92.14070129}, 'MLB': {'lat': 28.10280036926269, 'lon': -80.64530182}, 'AUS': {'lat': 30.194499969482425, 'lon': -97.66989899}, 'LCK': {'lat': 39.813801, 'lon': -82.927803}, 'MQT': {'lat': 46.3535995483, 'lon': -87.395401}, 'TYS': {'lat': 35.81100082, 'lon': -83.9940033}, 'STL': {'lat': 38.748697, 'lon': -90.370003}, 'SPS': {'lat': 33.9888, 'lon': -98.491898}, 'GRR': {'lat': 42.88079834, 'lon': -85.52279663}, 'FAT': {'lat': 36.77619934082031, 'lon': -119.7180023}, 'BNA': {'lat': 36.12450027, 'lon': -86.67819977}, 'LRD': {'lat': 27.543800354003903, 'lon': -99.46160126}, 'OTZ': {'lat': 66.88469696, 'lon': -162.598999}, 'LGA': {'lat': 40.77719879, 'lon': -73.87259674}, 'TLH': {'lat': 30.396499633789062, 'lon': -84.35030365}, 'ACT': {'lat': 31.611299514770508, 'lon': -97.23049927}, 'SJT': {'lat': 31.35770034790039, 'lon': -100.4960022}, 'BTV': {'lat': 44.4719009399, 'lon': -73.15329742}, 'JAX': {'lat': 30.49410057067871, 'lon': -81.68789673}, 'DRO': {'lat': 37.1515007, 'lon': -107.7539978}, 'IAD': {'lat': 38.94449997, 'lon': -77.45580292}, 'CLL': {'lat': 30.58860016, 'lon': -96.36380005}, 'MKE': {'lat': 42.94720077514648, 'lon': -87.89659882}, 'ABI': {'lat': 32.41130066, 'lon': -99.68190002}, 'COU': {'lat': 38.81809997558594, 'lon': -92.21959686}, 'PDX': {'lat': 45.58869934, 'lon': -122.5979996}, 'PBI': {'lat': 26.68320083618164, 'lon': -80.09559631}, 'OGS': {'lat': 44.68190002, 'lon': -75.46549988}, 'HNL': {'lat': 21.32062, 'lon': -157.924228}, 'DSM': {'lat': 41.53400039672852, 'lon': -93.6631012}, 'EWN': {'lat': 35.07300186, 'lon': -77.04290009}, 'SAN': {'lat': 32.73360062, 'lon': -117.1900024}, 'MLU': {'lat': 32.51089859008789, 'lon': -92.03769684}, 'ONT': {'lat': 34.055999755859375, 'lon': -117.6009979}, 'ROW': {'lat': 33.30160140991211, 'lon': -104.5309982}, 'BRO': {'lat': 25.90679931640625, 'lon': -97.42590332}, 'DHN': {'lat': 31.3213005065918, 'lon': -85.44960022}, 'CRP': {'lat': 27.77039909362793, 'lon': -97.50119781}, 'SYR': {'lat': 43.11119842529297, 'lon': -76.10630035}, 'MDW': {'lat': 41.785999, 'lon': -87.752403}, 'SJC': {'lat': 37.362598, 'lon': -121.929001}, 'HOB': {'lat': 32.6875, 'lon': -103.2170029}, 'DEN': {'lat': 39.86169815, 'lon': -104.6729965}, 'PHL': {'lat': 39.87189865112305, 'lon': -75.2410965}, 'SUX': {'lat': 42.40259933, 'lon': -96.38439941}, 'CMH': {'lat': 39.998001, 'lon': -82.891899}, 'TXK': {'lat': 33.45370101928711, 'lon': -93.99099731}, 'PBG': {'lat': 44.6509017944336, 'lon': -73.4681015}, 'ANC': {'lat': 61.17440032958984, 'lon': -149.9960022}, 'GRK': {'lat': 31.06719971, 'lon': -97.8289032}, 'BLI': {'lat': 48.79280090332031, 'lon': -122.538002}, 'MOB': {'lat': 30.69120026, 'lon': -88.24279785}, 'SAF': {'lat': 35.61709976, 'lon': -106.0889969}, 'BLV': {'lat': 38.5452, 'lon': -89.835197}, 'DRT': {'lat': 29.37420082, 'lon': -100.927002}, 'RSW': {'lat': 26.53619956970215, 'lon': -81.75520325}, 'AKN': {'lat': 58.67679977, 'lon': -156.6490021}, 'CYS': {'lat': 41.15570068, 'lon': -104.8119965}, 'SCK': {'lat': 37.89419937, 'lon': -121.237999}, 'CHS': {'lat': 32.89860153, 'lon': -80.04049683}, 'RNO': {'lat': 39.49909973144531, 'lon': -119.7679977}, 'KTN': {'lat': 55.35559845, 'lon': -131.7140045}, 'BHM': {'lat': 33.56290054, 'lon': -86.75350189}, 'SMF': {'lat': 38.69540023803711, 'lon': -121.5910034}, 'COS': {'lat': 38.805801, 'lon': -104.700996}, 'BUF': {'lat': 42.94049835, 'lon': -78.73220062}, 'PAE': {'lat': 47.90629959, 'lon': -122.2819977}, 'CDC': {'lat': 37.70100021362305, 'lon': -113.098999}, 'BDL': {'lat': 41.93889999, 'lon': -72.68319702}, 'MFE': {'lat': 26.17580032, 'lon': -98.23860168}, 'LBB': {'lat': 33.663601, 'lon': -101.822998}, 'FAI': {'lat': 64.81510162, 'lon': -147.8560028}, 'ART': {'lat': 43.99190139770508, 'lon': -76.021698}, 'PSP': {'lat': 33.82970047, 'lon': -116.5070038}, 'AMA': {'lat': 35.219398, 'lon': -101.706001}, 'FOD': {'lat': 42.55149841, 'lon': -94.19259644}, 'ILM': {'lat': 34.270599365234375, 'lon': -77.90260315}, 'BTR': {'lat': 30.533199, 'lon': -91.149597}, 'TYR': {'lat': 32.35409927368164, 'lon': -95.40239716}, 'BWI': {'lat': 39.1754, 'lon': -76.668297}, 'AEX': {'lat': 31.32740020751953, 'lon': -92.54979706}, 'CDB': {'lat': 55.20610046386719, 'lon': -162.7250061}, 'TUL': {'lat': 36.19839859008789, 'lon': -95.88809967}, 'SIT': {'lat': 57.04710006713867, 'lon': -135.3619995}, 'ISP': {'lat': 40.79520035, 'lon': -73.10019684}, 'MSP': {'lat': 44.882, 'lon': -93.221802}, 'ILG': {'lat': 39.67869949, 'lon': -75.60649872}, 'MSY': {'lat': 29.99340057373047, 'lon': -90.25800323}, 'PWM': {'lat': 43.64619827, 'lon': -70.30930328}, 'OKC': {'lat': 35.39310073852539, 'lon': -97.60070038}, 'ALB': {'lat': 42.74829864501953, 'lon': -73.80169678}, 'SNA': {'lat': 33.67570114, 'lon': -117.8679962}, 'CPR': {'lat': 42.908001, 'lon': -106.463997}, 'VPS': {'lat': 30.4832, 'lon': -86.525398}, 'EYW': {'lat': 24.556100845336918, 'lon': -81.75959778}, 'CLT': {'lat': 35.2140007, 'lon': -80.94309998}, 'LAS': {'lat': 36.08010101, 'lon': -115.1520004}, 'MCO': {'lat': 28.429399490356445, 'lon': -81.30899811}, 'FLO': {'lat': 34.18539810180664, 'lon': -79.72389984}, 'GTF': {'lat': 47.48199844, 'lon': -111.3710022}, 'PUW': {'lat': 46.7439, 'lon': -117.110001}, 'LWS': {'lat': 46.37450027, 'lon': -117.0149994}, 'ELM': {'lat': 42.15990067, 'lon': -76.89160156}, 'ITH': {'lat': 42.49100112915039, 'lon': -76.45839691}, 'MRY': {'lat': 36.58700180053711, 'lon': -121.8430023}, 'SBA': {'lat': 34.42620087, 'lon': -119.8399963}, 'DAB': {'lat': 29.179899, 'lon': -81.058098}, 'HVN': {'lat': 41.26369858, 'lon': -72.88680267}, 'AVL': {'lat': 35.43619918823242, 'lon': -82.54180145}, 'GSO': {'lat': 36.097801208496094, 'lon': -79.93730164}, 'FSD': {'lat': 43.5820007324, 'lon': -96.74189758}, 'MHT': {'lat': 42.932598, 'lon': -71.435699}, 'SDF': {'lat': 38.1744, 'lon': -85.736}, 'CHO': {'lat': 38.13859939575195, 'lon': -78.45290375}, 'ROA': {'lat': 37.3255, 'lon': -79.975403}, 'LEX': {'lat': 38.03649902, 'lon': -84.60590363}, 'EVV': {'lat': 38.03699875, 'lon': -87.53240204}, 'ABQ': {'lat': 35.040199, 'lon': -106.609001}, 'BZN': {'lat': 45.77750015, 'lon': -111.1529999}, 'BIL': {'lat': 45.80770111083984, 'lon': -108.5429993}, 'BTM': {'lat': 45.95479965209961, 'lon': -112.4970016}, 'TVC': {'lat': 44.74140167236328, 'lon': -85.5821991}, 'JAC': {'lat': 43.6072998, 'lon': -110.737999}, 'RFD': {'lat': 42.19540023803711, 'lon': -89.09719849}, 'GSP': {'lat': 34.89569855, 'lon': -82.21890259}, 'BMI': {'lat': 40.47710037, 'lon': -88.91590118}, 'GPT': {'lat': 30.40730094909668, 'lon': -89.07009888}, 'AZO': {'lat': 42.234901428222656, 'lon': -85.55210114}, 'TOL': {'lat': 41.58679962, 'lon': -83.80780029}, 'FWA': {'lat': 40.97850037, 'lon': -85.19509888}, 'DEC': {'lat': 39.834598541259766, 'lon': -88.86569977}, 'CID': {'lat': 41.88470077514648, 'lon': -91.71080017}, 'LSE': {'lat': 43.879002, 'lon': -91.256699}, 'CWA': {'lat': 44.77759933, 'lon': -89.66680145}, 'PIA': {'lat': 40.664199829100006, 'lon': -89.69329834}, 'ATW': {'lat': 44.2580986023, 'lon': -88.51909637}, 'RST': {'lat': 43.90829849243164, 'lon': -92.5}, 'CMI': {'lat': 40.03919983, 'lon': -88.27809906}, 'MHK': {'lat': 39.14099884033203, 'lon': -96.67079926}, 'GJT': {'lat': 39.12239838, 'lon': -108.5270004}, 'SGU': {'lat': 37.036389, 'lon': -113.510306}, 'SRQ': {'lat': 27.39539909362793, 'lon': -82.55439758}, 'MLI': {'lat': 41.44850158691406, 'lon': -90.50749969}, 'BIS': {'lat': 46.77270126342773, 'lon': -100.7460022}, 'RAP': {'lat': 44.04529953, 'lon': -103.0569992}, 'FNT': {'lat': 42.96540069580078, 'lon': -83.74359894}, 'RDD': {'lat': 40.50899887, 'lon': -122.2929993}, 'EUG': {'lat': 44.12459945678711, 'lon': -123.211998}, 'IDA': {'lat': 43.514599, 'lon': -112.070999}, 'MFR': {'lat': 42.37419891357422, 'lon': -122.8730011}, 'RDM': {'lat': 44.2541008, 'lon': -121.1500015}, 'CAK': {'lat': 40.91609954833984, 'lon': -81.44219971}, 'HSV': {'lat': 34.6371994, 'lon': -86.77510071}, 'MGM': {'lat': 32.30059814, 'lon': -86.39399719}, 'TRI': {'lat': 36.475201, 'lon': -82.407401}, 'PAH': {'lat': 37.06079864501953, 'lon': -88.77380371}, 'FCA': {'lat': 48.31050109863281, 'lon': -114.2559967}, 'MBS': {'lat': 43.532901763916016, 'lon': -84.07959747}, 'BGM': {'lat': 42.20869827, 'lon': -75.97979736}, 'PSG': {'lat': 56.80170059, 'lon': -132.9450073}, 'SFB': {'lat': 28.7775993347168, 'lon': -81.23750305}, 'JST': {'lat': 40.31610107421875, 'lon': -78.83390045}, 'MSO': {'lat': 46.91630173, 'lon': -114.0910034}, 'EGE': {'lat': 39.64260101, 'lon': -106.9179993}, 'CSG': {'lat': 32.516300201416016, 'lon': -84.93890381}, 'LAW': {'lat': 34.56769943, 'lon': -98.41660309}, 'FLG': {'lat': 35.13850021, 'lon': -111.6709976}, 'TWF': {'lat': 42.4818, 'lon': -114.487999}, 'MVY': {'lat': 41.39310074, 'lon': -70.61430359}, 'STC': {'lat': 45.54660034179688, 'lon': -94.05989838}, 'GTR': {'lat': 33.450298309299995, 'lon': -88.59140015}, 'ERI': {'lat': 42.08312701, 'lon': -80.17386675}, 'HYA': {'lat': 41.66930008, 'lon': -70.28040314}, 'CRW': {'lat': 38.37310028076172, 'lon': -81.59320068}, 'AVP': {'lat': 41.3385009766, 'lon': -75.7233963}, 'BJI': {'lat': 47.50939941, 'lon': -94.93370056}, 'FAR': {'lat': 46.92070007324219, 'lon': -96.81580353}, 'GCC': {'lat': 44.3488998413, 'lon': -105.5390015}, 'SCE': {'lat': 40.84930038, 'lon': -77.84870148}, 'MEI': {'lat': 32.33259963989258, 'lon': -88.75189972}, 'SPI': {'lat': 39.84410095, 'lon': -89.67790222}, 'HDN': {'lat': 40.48120117, 'lon': -107.2180023}, 'LBL': {'lat': 37.0442009, 'lon': -100.9599991}, 'COD': {'lat': 44.52019882, 'lon': -109.0240021}, 'SGF': {'lat': 37.24570084, 'lon': -93.38860321}, 'JLN': {'lat': 37.151798248291016, 'lon': -94.49829865}, 'ABE': {'lat': 40.65209961, 'lon': -75.44080353}, 'XNA': {'lat': 36.281898, 'lon': -94.306801}, 'SBN': {'lat': 41.70869827270508, 'lon': -86.31729889}, 'ACV': {'lat': 40.978101, 'lon': -124.109}, 'OAJ': {'lat': 34.82920074, 'lon': -77.61209869}, 'DBQ': {'lat': 42.40200043, 'lon': -90.70950317}, 'ABR': {'lat': 45.449100494384766, 'lon': -98.42179871}, 'ABY': {'lat': 31.535499572753903, 'lon': -84.19450378}, 'ALO': {'lat': 42.55709838867188, 'lon': -92.40029907}, 'ALW': {'lat': 46.09489822, 'lon': -118.288002}, 'APN': {'lat': 45.0780983, 'lon': -83.56030273}, 'ATY': {'lat': 44.91400146, 'lon': -97.15470123}, 'BFF': {'lat': 41.87400055, 'lon': -103.5960007}, 'BQK': {'lat': 31.2588005065918, 'lon': -81.46649933}, 'CGI': {'lat': 37.22529983520508, 'lon': -89.57080078}, 'CIU': {'lat': 46.25080108642578, 'lon': -84.47239685}, 'CKB': {'lat': 39.29660034, 'lon': -80.22810364}, 'CMX': {'lat': 47.168399810791016, 'lon': -88.4890976}, 'DDC': {'lat': 37.76340103149414, 'lon': -99.96559906}, 'EAU': {'lat': 44.86579895019531, 'lon': -91.48429871}, 'EKO': {'lat': 40.82490158081055, 'lon': -115.7919998}, 'FAY': {'lat': 34.99119949, 'lon': -78.88030243}, 'GRI': {'lat': 40.96749877929688, 'lon': -98.30960083}, 'HTS': {'lat': 38.36669922, 'lon': -82.55799866}, 'JMS': {'lat': 46.92969894, 'lon': -98.67819977}, 'LAR': {'lat': 41.31209945678711, 'lon': -105.6750031}, 'LBE': {'lat': 40.27590179, 'lon': -79.40480042}, 'LBF': {'lat': 41.12620163, 'lon': -100.6839981}, 'LYH': {'lat': 37.326698303222656, 'lon': -79.20040131}, 'MKG': {'lat': 43.16949844, 'lon': -86.23819733}, 'OTH': {'lat': 43.41709899902344, 'lon': -124.2460022}, 'OWB': {'lat': 37.74010086, 'lon': -87.16680145}, 'PIB': {'lat': 31.467100143432617, 'lon': -89.33709717}, 'PIH': {'lat': 42.90980148, 'lon': -112.5960007}, 'PIR': {'lat': 44.38270187, 'lon': -100.2860031}, 'PLN': {'lat': 45.57089996, 'lon': -84.79669952}, 'PSM': {'lat': 43.07789993, 'lon': -70.82330322}, 'RHI': {'lat': 45.63119888305664, 'lon': -89.46749878}, 'RKS': {'lat': 41.5942, 'lon': -109.065001}, 'SBP': {'lat': 35.2368011475, 'lon': -120.6419983}, 'SHR': {'lat': 44.76919937133789, 'lon': -106.9800034}, 'SLN': {'lat': 38.79100036621094, 'lon': -97.65219879}, 'SMX': {'lat': 34.89889908, 'lon': -120.4570007}, 'UIN': {'lat': 39.94269943, 'lon': -91.19460297}, 'VCT': {'lat': 28.85260009765625, 'lon': -96.91850281}, 'VLD': {'lat': 30.78249931335449, 'lon': -83.27670288}, 'YKM': {'lat': 46.56819916, 'lon': -120.5439987}, 'ADK': {'lat': 51.87799835205078, 'lon': -176.6459961}, 'GST': {'lat': 58.4253006, 'lon': -135.7070007}, 'WRG': {'lat': 56.48429871, 'lon': -132.3699951}, 'PSC': {'lat': 46.26470184326172, 'lon': -119.1190033}, 'ORH': {'lat': 42.26729965209961, 'lon': -71.8757019}, 'USA': {'lat': 35.387798, 'lon': -80.709099}, 'SUN': {'lat': 43.50439835, 'lon': -114.2959976}, 'MCW': {'lat': 43.157798767100005, 'lon': -93.33129883}, 'AZA': {'lat': 33.30780029, 'lon': -111.6549988}, 'HGR': {'lat': 39.707901, 'lon': -77.72949982}, 'ESC': {'lat': 45.72269821, 'lon': -87.09369659}, 'YAK': {'lat': 59.50329971, 'lon': -139.6600037}, 'IMT': {'lat': 45.81840134, 'lon': -88.11450195}, 'MTJ': {'lat': 38.5097999573, 'lon': -107.8939972}, 'RIW': {'lat': 43.06420136, 'lon': -108.4599991}, 'EAT': {'lat': 47.39889908, 'lon': -120.2070007}, 'BRD': {'lat': 46.39830017, 'lon': -94.13809967}, 'LWB': {'lat': 37.85829926, 'lon': -80.39949799}, 'PGV': {'lat': 35.6352005, 'lon': -77.38529968}, 'BKG': {'lat': 36.532082, 'lon': -93.200544}, 'STS': {'lat': 38.50899887, 'lon': -122.8130035}, 'ASE': {'lat': 39.22320175, 'lon': -106.8690033}, 'HYS': {'lat': 38.84220123, 'lon': -99.27320099}, 'GUC': {'lat': 38.53390121, 'lon': -106.9329987}, 'PGD': {'lat': 26.92020035, 'lon': -81.9905014}, 'SHD': {'lat': 38.26380157, 'lon': -78.89640045}, 'DVL': {'lat': 48.11420059, 'lon': -98.90879822}, 'DIK': {'lat': 46.79740143, 'lon': -102.802002}, 'WYS': {'lat': 44.68840027, 'lon': -111.1179962}, 'ALS': {'lat': 37.434898, 'lon': -105.866997}, 'CNY': {'lat': 38.75500107, 'lon': -109.7549973}, 'VEL': {'lat': 40.4408989, 'lon': -109.5100021}, 'MMH': {'lat': 37.62409973, 'lon': -118.8379974}, 'PVU': {'lat': 40.21920013, 'lon': -111.7229996}, 'ECP': {'lat': 30.357106, 'lon': -85.795414}, 'HHH': {'lat': 32.22439957, 'lon': -80.69750214}, 'OGD': {'lat': 41.19589996, 'lon': -112.012001}, 'SWO': {'lat': 36.16120148, 'lon': -97.08570099}, 'BIH': {'lat': 37.37310028, 'lon': -118.3639984}
}

# List of airline codes and airport codes as before
airline_codes = ["AA", "AS", "B6", "DL", "EV", "F9", "G4", "HA", "MQ", "NK", "OH", "OO", "QX", "UA", "WN", "YV", "YX"]
origin_codes = list(airport_coordinates.keys())
dest_codes = origin_codes

# Placeholder function to simulate predictions
def predict_delay(departure_code, arrival_code, airline_code, month):
    # Set average delay and standard deviation based on variance
    average_delay = 50  # in minutes
    variance = 1000  # in minutes squared
    std_dev = np.sqrt(variance)  # standard deviation for normal distribution
    
    # Generate a random delay time
    random_delay = max(0, int(np.random.normal(average_delay, std_dev)))
    
    return f"Estimated delay for {airline_code} from {departure_code} to {arrival_code} in month {month} is {random_delay} minutes."


# Streamlit UI
st.title("Flight Delay Predictor with Map Visualization")

# Dropdown menus
departure_code = st.selectbox("Departure Code", origin_codes)
arrival_code = st.selectbox("Arrival Code", dest_codes)
airline_code = st.selectbox("Airline Code", airline_codes)
month = st.number_input("Month", min_value=1, max_value=12, step=1)

if st.button("Predict Delay"):
    result = predict_delay(departure_code, arrival_code, airline_code, month)
    st.write(result)

    # Check if selected codes have coordinates
    if departure_code in airport_coordinates and arrival_code in airport_coordinates:
        # Retrieve coordinates for departure and arrival locations
        departure_coords = airport_coordinates[departure_code]
        arrival_coords = airport_coordinates[arrival_code]

        # Data for map visualization
        data = [
            {"name": "Departure", "lat": departure_coords["lat"], "lon": departure_coords["lon"], "color": [0, 0, 255]},
            {"name": "Arrival", "lat": arrival_coords["lat"], "lon": arrival_coords["lon"], "color": [255, 0, 0]},
        ]

        # Define the scatter plot layer for dots
        scatter_layer = pdk.Layer(
            "ScatterplotLayer",
            data=data,
            get_position=["lon", "lat"],
            get_color="color",
            get_radius=50000,  # Radius in meters
        )

        # Define the text layer for labels
        text_layer = pdk.Layer(
            "TextLayer",
            data=data,
            get_position=["lon", "lat"],
            get_text="name",
            get_color="color",
            get_size=24,
            get_alignment_baseline="'bottom'",
        )

        # Set the view state
        view_state = pdk.ViewState(
            latitude=(departure_coords["lat"] + arrival_coords["lat"]) / 2,
            longitude=(departure_coords["lon"] + arrival_coords["lon"]) / 2,
            zoom=3,
            pitch=0,
        )

        # Render the map
        st.pydeck_chart(pdk.Deck(layers=[scatter_layer, text_layer], initial_view_state=view_state))

    else:
        st.write("Coordinates for selected airports not found. Please add more coordinates to the dictionary.")